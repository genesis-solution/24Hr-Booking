(function(c,b,e,a){var d,i,h;d={activateCurrent:function(f){this.html_element.find("select").val(f)},getHtml:function(){var j=this,g="",f;if(1<this.ln){g+='<select class="dropdown controls '+this.o.controls_cssclass+'">';this.ShowOnMenu(this.view_all_key)&&(g+='<option value="'+this.view_all_key+'">'+this.o.view_all_text+"</option>");for(f=0;f<this.ln;f+=1){this.ShowOnMenu(f)&&(g+='<option value="'+(f+1)+'">'+(this.o.locations[f].title||"#"+(f+1))+"</option>")}g=c(g+"</select>").bind("change",function(){j.ViewOnMap(this.value)})}(f=this.o.controls_title)&&(f=c('<div class="controls_title"></div>').css(this.o.controls_applycss?{fontWeight:"bold",fontSize:this.o.controls_on_map?"12px":"inherit",padding:"3px 10px 5px 0"}:{}).append(this.o.controls_title));return this.html_element=c('<div class="wrap_controls"></div>').append(f).append(g)}};i={html_a:function(j,g,f){var k=this;g=g||j+1;f=f||this.o.locations[j].title;j=c('<a data-load="'+g+'" id="ullist_a_'+g+'" href="#'+g+'" title="'+f+'"><span>'+(f||"#"+(j+1))+"</span></a>");j.css(this.o.controls_applycss?{color:"#666",display:"block",padding:"5px",fontSize:this.o.controls_on_map?"12px":"inherit",textDecoration:"none"}:{});j.on("click",function(l){l.preventDefault();l=c(this).attr("data-load");k.ViewOnMap(l)});return j},activateCurrent:function(f){this.html_element.find("li").removeClass("active");this.html_element.find("#ullist_a_"+f).parent().addClass("active")},getHtml:function(){var g=c("<ul class='ullist controls "+this.o.controls_cssclass+"'></ul>").css(this.o.controls_applycss?{margin:0,padding:0,listStyleType:"none"}:{}),f;this.ShowOnMenu(this.view_all_key)&&g.append(c("<li></li>").append(i.html_a.call(this,!1,this.view_all_key,this.o.view_all_text)));for(f=0;f<this.ln;f++){this.ShowOnMenu(f)&&g.append(c("<li></li>").append(i.html_a.call(this,f)))}(f=this.o.controls_title)&&(f=c('<div class="controls_title"></div>').css(this.o.controls_applycss?{fontWeight:"bold",padding:"3px 10px 5px 0",fontSize:this.o.controls_on_map?"12px":"inherit"}:{}).append(this.o.controls_title));return this.html_element=c('<div class="wrap_controls"></div>').append(f).append(g)}};h=function(){function f(g){this.VERSION="0.1.33";this.loaded=!1;this.markers=[];this.circles=[];this.oMap=!1;this.view_all_key="all";this.infowindow=null;this.ln=this.maxZIndex=0;this.oMap=!1;this.directionsDisplay=this.directionsService=this.Fusion=this.Polygon=this.Polyline=this.current_index=this.current_control=this.controls_wrapper=this.canvas_map=this.map_div=this.oBounds=null;this.o={debug:!1,map_div:"#gmap",controls_div:"#controls",generate_controls:!0,controls_type:"dropdown",controls_cssclass:"",controls_title:"",controls_on_map:!0,controls_applycss:!0,controls_position:e.maps.ControlPosition.RIGHT_TOP,type:"marker",view_all:!0,view_all_text:"View All",pan_on_click:!0,start:0,locations:[],shared:{},map_options:{mapTypeId:e.maps.MapTypeId.ROADMAP},stroke_options:{strokeColor:"#0000FF",strokeOpacity:0.8,strokeWeight:2,fillColor:"#0000FF",fillOpacity:0.4},directions_options:{travelMode:e.maps.TravelMode.DRIVING,unitSystem:e.maps.UnitSystem.METRIC,optimizeWaypoints:!1,provideRouteAlternatives:!1,avoidHighways:!1,avoidTolls:!1},circle_options:{radius:100,visible:!0},styles:{},fusion_options:{},directions_panel:null,draggable:!1,editable:!1,show_infowindows:!0,show_markers:!0,infowindow_type:"bubble",listeners:{},beforeViewAll:function(){},afterViewAll:function(){},beforeShow:function(j,l,k){},afterShow:function(j,l,k){},afterCreateMarker:function(j,l,k){},beforeCloseInfowindow:function(j,k){},afterCloseInfowindow:function(j,k){},beforeOpenInfowindow:function(j,l,k){},afterOpenInfowindow:function(j,l,k){},afterRoute:function(j,l,k){},onPolylineClick:function(j){},onPolygonClick:function(j){},circleRadiusChanged:function(j,l,k){},circleCenterChanged:function(j,l,k){},drag:function(j,l,k){},dragEnd:function(j,l,k){},dragStart:function(j,l,k){}};this.AddControl("dropdown",d);this.AddControl("list",i);g&&"directions"===g.type&&(!g.show_markers&&(g.show_markers=!1),!g.show_infowindows&&(g.show_infowindows=!1));c.extend(!0,this.o,g)}f.prototype.controls={};f.prototype.create_objMap=function(){var j=0,g;for(g in this.o.styles){this.o.styles.hasOwnProperty(g)&&(0===j&&(this.o.map_options.mapTypeControlOptions={mapTypeIds:[e.maps.MapTypeId.ROADMAP]}),j++,this.o.map_options.mapTypeControlOptions.mapTypeIds.push("map_style_"+j))}if(this.loaded){this.oMap.setOptions(this.o.map_options)}else{try{this.map_div.css({position:"relative",overflow:"hidden"}),this.canvas_map=c("<div>").addClass("canvas_map").css({width:"100%",height:"100%"}).appendTo(this.map_div),this.oMap=new e.maps.Map(this.canvas_map.get(0),this.o.map_options)}catch(k){this.debug("create_objMap::"+this.map_div.selector,k.toString())}}j=0;for(g in this.o.styles){this.o.styles.hasOwnProperty(g)&&(j++,this.oMap.mapTypes.set("map_style_"+j,new e.maps.StyledMapType(this.o.styles[g],{name:g})),this.oMap.setMapTypeId("map_style_"+j))}};f.prototype.add_markers_to_objMap=function(){var j,g;j=this.o.type||"marker";switch(j){case"marker":for(j=0;j<this.ln;j++){g=this.create_objPoint(j),this.create.marker.call(this,j,g)}break;default:this.create[j].apply(this)}};f.prototype.create_objPoint=function(j){j=c.extend({},this.o.locations[j]);var g=j.visible===a?a:j.visible;!j.type&&(j.type=this.o.type);j.map=this.oMap;j.position=new e.maps.LatLng(j.lat,j.lon);j.zIndex=j.zIndex===a?10000:j.zIndex+100;j.visible=g===a?this.o.show_markers:g;this.o.maxZIndex=j.zIndex>this.maxZIndex?j.zIndex:this.maxZIndex;j.image&&(j.icon=new e.maps.MarkerImage(j.image,new e.maps.Size(j.image_w||32,j.image_h||32),new e.maps.Point(0,0),new e.maps.Point((j.image_w||32)/2,(j.image_h||32)/2)));return j};f.prototype.create_objCircle=function(j){var g,l,k;k=c.extend({},j);g=c.extend({},this.o.stroke_options);l=c.extend({},this.o.circle_options);c.extend(g,j.stroke_options||{});c.extend(k,g);c.extend(l,j.circle_options||{});c.extend(k,l);k.center=j.position;k.draggable=!1;k.zIndex=0<j.zIndex?j.zIndex-10:1;return k};f.prototype.add_markerEv=function(j,g,l){var k=this;e.maps.event.addListener(l,"click",function(m){k.o.beforeShow(j,g,l);k.o.show_infowindows&&!1!==g.show_infowindow&&k.open_infowindow(j,l,m);k.o.pan_on_click&&!1!==g.pan_on_click&&(k.oMap.panTo(g.position),g.zoom&&k.oMap.setZoom(g.zoom));k.current_control&&k.o.generate_controls&&k.current_control.activateCurrent&&k.current_control.activateCurrent.call(k,j+1);k.current_index=j;k.o.afterShow(j,g,l)});g.draggable&&this.add_dragEv(j,g,l)};f.prototype.add_circleEv=function(j,g,l){var k=this;e.maps.event.addListener(l,"click",function(){k.ViewOnMap(j+1)});e.maps.event.addListener(l,"center_changed",function(){k.o.circleCenterChanged(j,g,l)});e.maps.event.addListener(l,"radius_changed",function(){k.o.circleRadiusChanged(j,g,l)});g.draggable&&this.add_dragEv(j,g,l)};f.prototype.add_dragEv=function(j,g,l){var k=this;e.maps.event.addListener(l,"drag",function(q){var p;if(l.getPosition){q=l.getPosition()}else{if(l.getCenter){q=l.getCenter()}else{return}}k.circles[j]&&k.circles[j].setCenter(q);k.Polyline?p="Polyline":k.Polygon&&(p="Polygon");if(p){for(var n=k[p].getPath().getArray(),o=[],m=0;m<n.length;++m){o[m]=j===m?new e.maps.LatLng(q.lat(),q.lng()):new e.maps.LatLng(n[m].lat(),n[m].lng())}k[p].setPath(new e.maps.MVCArray(o));k.add_polyEv(p)}k.o.drag(j,g,l)});e.maps.event.addListener(l,"dragend",function(){k.o.dragEnd(j,g,l)});e.maps.event.addListener(l,"dragstart",function(){k.o.dragStart(j,g,l)});e.maps.event.addListener(l,"center_changed",function(){k.markers[j]&&l.getCenter&&k.markers[j].setPosition(l.getCenter());k.o.drag(j,g,l)})};f.prototype.add_polyEv=function(j){var g=this;e.maps.event.addListener(this[j].getPath(),"set_at",function(m,l){var k=g[j].getPath().getAt(m),k=new e.maps.LatLng(k.lat(),k.lng());g.markers[m]&&g.markers[m].setPosition(k);g.circles[m]&&g.circles[m].setCenter(k);g.o["on"+j+"Changed"](m,l,g[j].getPath().getArray())})};f.prototype.create={marker:function(j,g,l){var k;"circle"!=g.type||l||(k=this.create_objCircle(g),g.visible||(k.draggable=g.draggable),l=new e.maps.Circle(k),this.add_circleEv(j,k,l),this.circles[j]=l);g.type="marker";l=new e.maps.Marker(g);this.add_markerEv(j,g,l);this.oBounds.extend(g.position);this.markers[j]=l;this.o.afterCreateMarker(j,g,l);return l},circle:function(){var j,g,l,k;for(j=0;j<this.ln;j++){g=this.create_objPoint(j),"circle"==g.type&&(l=this.create_objCircle(g),g.visible||(l.draggable=g.draggable),k=new e.maps.Circle(l),this.add_circleEv(j,l,k),this.circles[j]=k),g.type="marker",this.create.marker.call(this,j,g,k)}},polyline:function(){var j,g,k=c.extend({},this.o.stroke_options);k.path=[];k.draggable=this.o.draggable;k.editable=this.o.editable;k.map=this.oMap;k.zIndex=this.o.maxZIndex+100;for(j=0;j<this.ln;j++){g=this.create_objPoint(j),this.create.marker.call(this,j,g),k.path.push(g.position)}this.Polyline?this.Polyline.setOptions(k):this.Polyline=new e.maps.Polyline(k);this.add_polyEv("Polyline")},polygon:function(){var j=this,g,l,k=c.extend({},this.o.stroke_options);k.path=[];k.draggable=this.o.draggable;k.editable=this.o.editable;k.map=this.oMap;k.zIndex=this.o.maxZIndex+100;for(g=0;g<this.ln;g++){l=this.create_objPoint(g),this.create.marker.call(this,g,l),k.path.push(l.position)}this.Polygon?this.Polygon.setOptions(k):this.Polygon=new e.maps.Polygon(k);e.maps.event.addListener(this.Polygon,"click",function(m){j.o.onPolygonClick(m)});this.add_polyEv("Polygon")},fusion:function(){this.o.fusion_options.styles=[this.o.stroke_options];this.o.fusion_options.map=this.oMap;this.Fusion?this.Fusion.setOptions(this.o.fusion_options):this.Fusion=new e.maps.FusionTablesLayer(this.o.fusion_options)},directions:function(){var j=this,g,q,p,o,n,l=[],m=0;for(g=0;g<this.ln;g++){q=this.create_objPoint(g),0===g?o=q.position:g===this.ln-1?n=q.position:(p=!0===this.o.locations[g].stopover?!0:!1,l.push({location:q.position,stopover:p})),this.create.marker.call(this,g,q)}this.o.directions_options.origin=o;this.o.directions_options.destination=n;this.o.directions_options.waypoints=l;this.directionsService||(this.directionsService=new e.maps.DirectionsService);this.directionsDisplay?this.directionsDisplay.setOptions({draggable:this.o.draggable}):this.directionsDisplay=new e.maps.DirectionsRenderer({draggable:this.o.draggable});this.directionsDisplay.setMap(this.oMap);this.o.directions_panel&&(this.o.directions_panel=c(this.o.directions_panel),this.directionsDisplay.setPanel(this.o.directions_panel.get(0)));this.o.draggable&&e.maps.event.addListener(this.directionsDisplay,"directions_changed",function(){m=j.compute_distance(j.directionsDisplay.directions);j.o.afterRoute(m)});this.directionsService.route(this.o.directions_options,function(k,r){r===e.maps.DirectionsStatus.OK&&(m=j.compute_distance(k),j.directionsDisplay.setDirections(k));j.o.afterRoute(m,r,k)})}};f.prototype.compute_distance=function(j){var g=0,l=j.routes[0],k=l.legs.length;for(j=0;j<k;j++){g+=l.legs[j].distance.value}return g};f.prototype.type_to_open={bubble:function(g){this.infowindow=new e.maps.InfoWindow({content:g.html||""})}};f.prototype.open_infowindow=function(j,g,l){this.CloseInfoWindow();l=this.o.locations[j];var k=this.o.infowindow_type;l.html&&this.type_to_open[k]&&(this.o.beforeOpenInfowindow(j,l,g),this.type_to_open[k].call(this,l),this.infowindow.open(this.oMap,g),this.o.afterOpenInfowindow(j,l,g))};f.prototype.get_html_controls=function(){return this.controls[this.o.controls_type]&&this.controls[this.o.controls_type].getHtml?(this.current_control=this.controls[this.o.controls_type],this.current_control.getHtml.apply(this)):""};f.prototype.generate_controls=function(){if(this.o.controls_on_map){var j=c('<div class="on_gmap '+this.o.controls_type+' gmap_controls"></div>').css(this.o.controls_applycss?{margin:"5px"}:{}),g=c(this.get_html_controls()).css(this.o.controls_applycss?{background:"#fff",padding:"5px",border:"1px solid rgb(113,123,135)",boxShadow:"rgba(0, 0, 0, 0.4) 0px 2px 4px",maxHeight:this.map_div.find(".canvas_map").outerHeight()-80,minWidth:100,overflowY:"auto",overflowX:"hidden"}:{});j.append(g);this.oMap.controls[this.o.controls_position].push(j.get(0))}else{this.controls_wrapper.empty(),this.controls_wrapper.append(this.get_html_controls())}};f.prototype.init_map=function(){var j=this;this.Polyline&&this.Polyline.setMap(null);this.Polygon&&this.Polygon.setMap(null);this.Fusion&&this.Fusion.setMap(null);this.directionsDisplay&&this.directionsDisplay.setMap(null);for(var g=this.markers.length-1;0<=g;--g){try{this.markers[g]&&this.markers[g].setMap(null)}catch(l){j.debug("init_map::markers::setMap",l.stack)}}this.markers.length=0;this.markers=[];for(g=this.circles.length-1;0<=g;--g){try{this.circles[g]&&this.circles[g].setMap(null)}catch(k){j.debug("init_map::circles::setMap",k.stack)}}this.circles.length=0;this.circles=[];this.o.controls_on_map&&this.oMap.controls&&this.oMap.controls[this.o.controls_position].forEach(function(m,o){try{j.oMap.controls[this.o.controls_position].removeAt(o)}catch(n){j.debug("init_map::removeAt",n.stack)}});this.oBounds=new e.maps.LatLngBounds};f.prototype.perform_load=function(){1===this.ln?(this.o.map_options.set_center?this.oMap.setCenter(new e.maps.LatLng(this.o.map_options.set_center[0],this.o.map_options.set_center[1])):(this.oMap.fitBounds(this.oBounds),this.ViewOnMap(1)),this.o.map_options.zoom&&this.oMap.setZoom(this.o.map_options.zoom)):0===this.ln?(this.o.map_options.set_center?this.oMap.setCenter(new e.maps.LatLng(this.o.map_options.set_center[0],this.o.map_options.set_center[1])):this.oMap.fitBounds(this.oBounds),this.oMap.setZoom(this.o.map_options.zoom||1)):(this.oMap.fitBounds(this.oBounds),"number"===typeof(this.o.start-0)&&0<this.o.start&&this.o.start<=this.ln?this.ViewOnMap(this.o.start):this.o.map_options.set_center?this.oMap.setCenter(new e.maps.LatLng(this.o.map_options.set_center[0],this.o.map_options.set_center[1])):this.ViewOnMap(this.view_all_key),this.o.map_options.zoom&&this.oMap.setZoom(this.o.map_options.zoom))};f.prototype.debug=function(j,g){this.o.debug&&console.log(j,g);return this};f.prototype.AddControl=function(j,g){if(!j||!g){return self.debug("AddControl",'Missing "name" and "func" callback.'),!1}this.controls[j]=g;return this};f.prototype.CloseInfoWindow=function(){this.infowindow&&(this.current_index||0===this.current_index)&&(this.o.beforeCloseInfowindow(this.current_index,this.o.locations[this.current_index]),this.infowindow.close(),this.infowindow=null,this.o.afterCloseInfowindow(this.current_index,this.o.locations[this.current_index]));return this};f.prototype.ShowOnMenu=function(g){if(g===this.view_all_key&&this.o.view_all&&1<this.ln){return !0}g=parseInt(g,10);return"number"===typeof(g-0)&&0<=g&&g<this.ln&&!1!==this.o.locations[g].on_menu?!0:!1};f.prototype.ViewOnMap=function(j){if(j===this.view_all_key){this.o.beforeViewAll(),this.current_index=j,0<this.o.locations.length&&this.o.generate_controls&&this.current_control&&this.current_control.activateCurrent&&this.current_control.activateCurrent.apply(this,[j]),this.oMap.fitBounds(this.oBounds),this.CloseInfoWindow(),this.o.afterViewAll()}else{if(j=parseInt(j,10),"number"===typeof(j-0)&&0<j&&j<=this.ln){try{e.maps.event.trigger(this.markers[j-1],"click")}catch(g){this.debug("ViewOnMap::trigger",g.stack)}}}return this};f.prototype.SetLocations=function(j,g){this.o.locations=j;g&&this.Load();return this};f.prototype.AddLocations=function(j,g){var k=this;c.isArray(j)&&c.each(j,function(m,l){k.o.locations.push(l)});c.isPlainObject(j)&&this.o.locations.push(j);g&&this.Load();return this};f.prototype.AddLocation=function(j,g,k){c.isPlainObject(j)&&this.o.locations.splice(g,0,j);k&&this.Load();return this};f.prototype.RemoveLocations=function(j,g){var l=this,k=0;c.isArray(j)?c.each(j,function(n,m){m-k<l.ln&&l.o.locations.splice(m-k,1);k++}):j<this.ln&&this.o.locations.splice(j,1);g&&this.Load();return this};f.prototype.Loaded=function(){return this.loaded};f.prototype._init=function(){this.ln=this.o.locations.length;for(var j=0;j<this.ln;j++){var g=c.extend({},this.o.shared);this.o.locations[j]=c.extend(g,this.o.locations[j]);this.o.locations[j].html&&(this.o.locations[j].html=this.o.locations[j].html.replace("%index",j+1),this.o.locations[j].html=this.o.locations[j].html.replace("%title",this.o.locations[j].title||""))}this.map_div=c(this.o.map_div);this.controls_wrapper=c(this.o.controls_div);return this};f.prototype.Load=function(j){c.extend(!0,this.o,j);j&&j.locations&&(this.o.locations=j.locations);this._init();!1===this.o.visualRefresh?e.maps.visualRefresh=!1:e.maps.visualRefresh=!0;this.init_map();this.create_objMap();this.add_markers_to_objMap();1<this.ln&&this.o.generate_controls||this.o.force_generate_controls?(this.o.generate_controls=!0,this.generate_controls()):this.o.generate_controls=!1;var g=this;if(this.loaded){this.perform_load()}else{e.maps.event.addListenerOnce(this.oMap,"idle",function(){g.perform_load()});e.maps.event.addListener(this.oMap,"resize",function(){g.canvas_map.css({width:g.map_div.width(),height:g.map_div.height()})});for(var m in this.o.listeners){var l=this.oMap,k=this.o.listeners[m];this.o.listeners.hasOwnProperty(m)&&e.maps.event.addListener(this.oMap,m,function(n){k(l,n)})}}this.loaded=!0;return this};return f}();"function"==typeof define&&define.amd?define(function(){return h}):b.Maplace=h})(jQuery,this,google);