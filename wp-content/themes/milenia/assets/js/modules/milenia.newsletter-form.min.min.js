var MileniaNewsletter=(function(f){var d={url:"php/subscribe.php",onSuccess:function(a){},onError:function(a){}};function e(a,b){var c=this;this.form=a;this.config=b;this.initValidator();a.data("config",b)}e.prototype.initValidator=function(){var a=this;if(!(this.form.get(0) instanceof HTMLFormElement)||!window.Validator){return}this.form.data("validator",new Validator({form:a.form.get(0),cssPrefix:"apo-",incorrectClass:"invalid",correctClass:"valid",rules:[{element:a.form.get(0).elements.email,name:"Email",rules:{empty:null,pattern:/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i}}],onIncorrect:function(b){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:a.form,type:"error",message:b})}},onCorrect:a.send}))};e.prototype.send=function(){var b=f(this),a=b.data("config");f.ajax({url:a.url,type:"POST",dataType:"json",data:b.serialize(),success:function(c){if(c.status&&c.status=="fail"){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:b,type:"error",message:c.errors})}a.onError.call(b,c)}else{if(c.status&&c.status=="success"){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:b,type:"success",message:c.statusText})}b.find("input").val("");a.onSuccess.call(b,c)}}},error:function(j,c,i){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:b,type:"error",message:i})}a.onError.call(b,arguments)}})};return function(a,b){if(!a||!a.length){return false}b=b&&f.isPlainObject(b)?f.extend(true,{},d,b):d;return a.each(function(j,i){var c=f(i);if(c.data("Newsletter")){return}c.data("Newsletter",new e(c,b))})}})(jQuery);