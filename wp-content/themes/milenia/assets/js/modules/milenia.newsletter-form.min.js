var MileniaNewsletter=(function(c){var b={url:"php/subscribe.php",onSuccess:function(d){},onError:function(d){}};function a(f,e){var d=this;this.form=f;this.config=e;this.initValidator();f.data("config",e)}a.prototype.initValidator=function(){var d=this;if(!(this.form.get(0) instanceof HTMLFormElement)||!window.Validator){return}this.form.data("validator",new Validator({form:d.form.get(0),cssPrefix:"apo-",incorrectClass:"invalid",correctClass:"valid",rules:[{element:d.form.get(0).elements.email,name:"Email",rules:{empty:null,pattern:/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i}}],onIncorrect:function(e){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:d.form,type:"error",message:e})}},onCorrect:d.send}))};a.prototype.send=function(){var d=c(this),e=d.data("config");c.ajax({url:e.url,type:"POST",dataType:"json",data:d.serialize(),success:function(f){if(f.status&&f.status=="fail"){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:d,type:"error",message:f.errors})}e.onError.call(d,f)}else{if(f.status&&f.status=="success"){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:d,type:"success",message:f.statusText})}d.find("input").val("");e.onSuccess.call(d,f)}}},error:function(f,h,g){if(Milenia&&Milenia.modules&&Milenia.modules.alertMessage){Milenia.modules.alertMessage({target:d,type:"error",message:g})}e.onError.call(d,arguments)}})};return function(e,d){if(!e||!e.length){return false}d=d&&c.isPlainObject(d)?c.extend(true,{},b,d):b;return e.each(function(f,g){var h=c(g);if(h.data("Newsletter")){return}h.data("Newsletter",new a(h,d))})}})(jQuery);