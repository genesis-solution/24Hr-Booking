(function(n){var i={type:"html",content:"",url:"",ajax:{},ajax_request:null,closeOnEsc:!0,closeOnOverlayClick:!0,clone:!1,overlay:{block:void 0,tpl:'<div class="arcticmodal-overlay"></div>',css:{backgroundColor:"#000",opacity:0.6}},container:{block:void 0,tpl:'<div class="arcticmodal-container"><table class="arcticmodal-container_i"><tr><td class="arcticmodal-container_i2"></td></tr></table></div>'},wrap:void 0,body:void 0,errors:{tpl:'<div class="arcticmodal-error arcticmodal-close"></div>',autoclose_delay:2000,ajax_unsuccessful_load:"Error"},openEffect:{type:"fade",speed:400},closeEffect:{type:"fade",speed:400},beforeOpen:n.noop,afterOpen:n.noop,beforeClose:n.noop,afterClose:n.noop,afterLoading:n.noop,afterLoadingOnShow:n.noop,errorLoading:n.noop},b=0,l=n([]),a={isEventOut:function(e,d){var f=!0;n(e).each(function(){n(d.target).get(0)==n(this).get(0)&&(f=!1);0==n(d.target).closest("HTML",n(this).get(0)).length&&(f=!1)});return f}},k={getParentEl:function(e){var d=n(e);return d.data("arcticmodal")?d:(d=n(e).closest(".arcticmodal-container").data("arcticmodalParentEl"))?d:!1},transition:function(f,d,h,g){g=void 0==g?n.noop:g;switch(h.type){case"fade":"show"==d?f.fadeIn(h.speed,g):f.fadeOut(h.speed,g);break;case"none":"show"==d?f.show():f.hide(),g()}},prepare_body:function(e,d){n(".arcticmodal-close",e.body).unbind("click.arcticmodal").bind("click.arcticmodal",function(){d.arcticmodal("close");return !1})},init_el:function(f,d){var o=f.data("arcticmodal");if(!o){o=d;b++;o.modalID=b;o.overlay.block=n(o.overlay.tpl);o.overlay.block.css(o.overlay.css);o.container.block=n(o.container.tpl);o.body=n(".arcticmodal-container_i2",o.container.block);d.clone?o.body.html(f.clone(!0)):(f.before('<div id="arcticmodalReserve'+o.modalID+'" style="display: none" />'),o.body.html(f));k.prepare_body(o,f);o.closeOnOverlayClick&&o.overlay.block.add(o.container.block).click(function(g){a.isEventOut(n(">*",o.body),g)&&f.arcticmodal("close")});o.container.block.data("arcticmodalParentEl",f);f.data("arcticmodal",o);l=n.merge(l,f);n.proxy(c.show,f)();if("html"==o.type){return f}if(void 0!=o.ajax.beforeSend){var h=o.ajax.beforeSend;delete o.ajax.beforeSend}if(void 0!=o.ajax.success){var j=o.ajax.success;delete o.ajax.success}if(void 0!=o.ajax.error){var e=o.ajax.error;delete o.ajax.error}var m=n.extend(!0,{url:o.url,beforeSend:function(){void 0==h?o.body.html('<div class="arcticmodal-loading" />'):h(o,f)},success:function(g){f.trigger("afterLoading");o.afterLoading(o,f,g);void 0==j?o.body.html(g):j(o,f,g);k.prepare_body(o,f);f.trigger("afterLoadingOnShow");o.afterLoadingOnShow(o,f,g)},error:function(){f.trigger("errorLoading");o.errorLoading(o,f);void 0==e?(o.body.html(o.errors.tpl),n(".arcticmodal-error",o.body).html(o.errors.ajax_unsuccessful_load),n(".arcticmodal-close",o.body).click(function(){f.arcticmodal("close");return !1}),o.errors.autoclose_delay&&setTimeout(function(){f.arcticmodal("close")},o.errors.autoclose_delay)):e(o,f)}},o.ajax);o.ajax_request=n.ajax(m);f.data("arcticmodal",o)}},init:function(e){e=n.extend(!0,{},i,e);if(n.isFunction(this)){if(void 0==e){n.error("jquery.arcticmodal: Uncorrect parameters")}else{if(""==e.type){n.error('jquery.arcticmodal: Don\'t set parameter "type"')}else{switch(e.type){case"html":if(""==e.content){n.error('jquery.arcticmodal: Don\'t set parameter "content"');break}var d=e.content;e.content="";return k.init_el(n(d),e);case"ajax":if(""==e.url){n.error('jquery.arcticmodal: Don\'t set parameter "url"');break}return k.init_el(n("<div />"),e)}}}}else{return this.each(function(){k.init_el(n(this),n.extend(!0,{},e))})}}},c={show:function(){var e=k.getParentEl(this);if(!1===e){n.error("jquery.arcticmodal: Uncorrect call")}else{var d=e.data("arcticmodal");d.overlay.block.hide();d.container.block.hide();n("BODY").append(d.overlay.block);n("BODY").append(d.container.block);d.beforeOpen(d,e);e.trigger("beforeOpen");if("hidden"!=d.wrap.css("overflow")){d.wrap.data("arcticmodalOverflow",d.wrap.css("overflow"));var h=d.wrap.outerWidth(!0);d.wrap.css("overflow","hidden");var f=d.wrap.outerWidth(!0);f!=h&&d.wrap.css("marginRight",f-h+"px")}l.not(e).each(function(){n(this).data("arcticmodal").overlay.block.hide()});k.transition(d.overlay.block,"show",1<l.length?{type:"none"}:d.openEffect);k.transition(d.container.block,"show",1<l.length?{type:"none"}:d.openEffect,function(){d.afterOpen(d,e);e.trigger("afterOpen")});return e}},close:function(){if(n.isFunction(this)){l.each(function(){n(this).arcticmodal("close")})}else{return this.each(function(){var e=k.getParentEl(this);if(!1===e){n.error("jquery.arcticmodal: Uncorrect call")}else{var d=e.data("arcticmodal");!1!==d.beforeClose(d,e)&&(e.trigger("beforeClose"),l.not(e).last().each(function(){n(this).data("arcticmodal").overlay.block.show()}),k.transition(d.overlay.block,"hide",1<l.length?{type:"none"}:d.closeEffect),k.transition(d.container.block,"hide",1<l.length?{type:"none"}:d.closeEffect,function(){d.afterClose(d,e);e.trigger("afterClose");d.clone||n("#arcticmodalReserve"+d.modalID).replaceWith(d.body.find(">*"));d.overlay.block.remove();d.container.block.remove();e.data("arcticmodal",null);n(".arcticmodal-container").length||(d.wrap.data("arcticmodalOverflow")&&d.wrap.css("overflow",d.wrap.data("arcticmodalOverflow")),d.wrap.css("marginRight",0))}),"ajax"==d.type&&d.ajax_request.abort(),l=l.not(e))}})}},setDefault:function(d){n.extend(!0,i,d)}};n(function(){i.wrap=n(document.all&&!document.querySelector?"html":"body")});n(document).bind("keyup.arcticmodal",function(e){var d=l.last();d.length&&d.data("arcticmodal").closeOnEsc&&27===e.keyCode&&d.arcticmodal("close")});n.arcticmodal=n.fn.arcticmodal=function(d){if(c[d]){return c[d].apply(this,Array.prototype.slice.call(arguments,1))}if("object"===typeof d||!d){return k.init.apply(this,arguments)}n.error("jquery.arcticmodal: Method "+d+" does not exist")}})(jQuery);